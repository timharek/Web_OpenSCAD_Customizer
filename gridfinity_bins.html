<!doctype html>
<html>
  <head>
    <script src="deps/three.min.js" defer></script>
    <script src="deps/Projector.js" defer></script>
    <script src="deps/stl_viewer.min.js" defer></script>
    <script src="deps/webgl_detector.js" defer></script>
    <script src="deps/OrbitControls.js" defer></script>
    <script src="deps/parser.min.js" defer></script>
    <script src="deps/TrackballControls.js" defer></script>
    <script src="deps/CanvasRenderer.js" defer></script>
    <script src="browserfs.min.js" defer></script>
    <link rel="stylesheet" href="/css/gridfinity.css" />

    <script>
      const model_path = "gridfinity_bins/gridfinity_basic_cup.scad"; // folder name (actually zip file) and source file name

      const outstl_name = "model_out.stl";

      const model_default_params = {
        width: 1,
        depth: 1,
        height: 6,
        magnet_diameter: 0,
        screw_depth: 0,
        hole_overhang_remedy: true,
        chambers: 1,
        withLabel: "disabled",
        fingerslide: true,
        labelWidth: 0,
        wall_thickness: 0.95,
        efficient_floor: false,
        lip_style: "normal",
      };

      const model_param_desriptions = {
        width: "Number of grid units left-to-right (x axis)",
        depth: "Number of grid units front-to-back (y axis)",
        height: "Height of bin in standard units (multiples of 7 mm)",
        magnet_diameter:
          "Include hole for magnet (Zack's design is 6.5 mm) or 0 to omit magnet hole",
        screw_depth:
          "Include deeper narrow hole for screw (Zack's design is 6 mm) or 0 to omit screw hole",
        hole_overhang_remedy:
          "If both screw and magnet are defined, include feature for better printing of magnet/screw overhang",
        chambers: "Number of subdivisions along x axis (uniform divisions)",
        withLabel:
          "Include overhang for label and control position, can be 'disabled', 'left', 'right', 'center', 'leftchanber', 'rightchamber', or 'centerchamber'",
        fingerslide: "Include large corner fillet on the front",
        labelWidth:
          "Width of label in number of units, or zero to indicate full width",
        wall_thickness: "Thickness of outer walls (Zack's design is 0.95)",
        efficient_floor:
          "Efficient floor option saves material and time, but the floor is not smooth (only applies if no magnets, screws, or finger-slide used)",
        lip_style:
          "Style of lip at top of walls, can be 'normal', 'reduced', or 'none'",
      };

      (async () => {
        if ("serviceWorker" in navigator) {
          for (const reg of await navigator.serviceWorker.getRegistrations()) {
            try {
              reg.unregister();
            } catch (e) {
              console.error(e, e.stackTrace);
            }
          }
        }
      })();
    </script>

    <script src="filesystem.js" defer></script>
    <script type="module" src="main.js" defer></script>
  </head>

  <body>
    <div class="root row">
      <div id="editor-panel" class="col">
        <button id="flip-mode">Flip</button>
        <div id="params"></div>
        <div>
          <br />
          <a href="" id="permalink">Link to current parameters</a>
        </div>
        <div class="logs-container">
          <pre><code id="logs"></code></pre>
        </div>
      </div>
      <div id="view-panel" class="col">
        <div class="text title desktop">
          <h2>Gridfinity Parametric Web Generator</h2>
        </div>
        <div class="text desktop">
          <a href="https://github.com/vector76/Web_OpenSCAD_Customizer"
            >Web OpenSCAD Customizer Project</a
          ><br />
          <a href="https://github.com/vector76/gridfinity_openscad"
            >Gridfinity OpenSCAD</a
          >
        </div>
        <div class="text desktop"></div>
        <div class="row text">
          <button class="button settings" id="run">Render (Ctrl+Enter)</button>
          <button class="button settings" id="kill" disabled>Kill</button>
          <div class="text-fragment" id="link-container"></div>
          <div class="text-fragment settings" id="meta"></div>
          <span class="spacer settings"></span>
          <span class="text-fragment settings"
            ><input type="checkbox" id="autorotate" checked />Rotate</span
          >
          <span class="spacer settings"></span>
        </div>
        <div id="viewer" tabindex="0"></div>
        <span id="features" class="features"></span>
      </div>
    </div>
  </body>
</html>
